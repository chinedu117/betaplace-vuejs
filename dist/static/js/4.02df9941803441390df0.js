webpackJsonp([4],{ZHHa:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("jRP+"),n=i("Vp1X"),r={data:function(){return{_maxWidth:800,_maxHeight:200,_compressionQuality:.8,profile:null}},components:{AgentInfo:i("Wgvv").a},computed:{card_style:function(){return this.$vuetify.breakpoint.smAndDown?{class:"mx-auto px-2"}:{width:"100%",class:"mx-auto pa-2"}},upload_button:function(){return this.$vuetify.breakpoint.smAndDown?{style:"position: relative; right: 40%; bottom:10% "}:{style:"position: relative; right: 40%; bottom:10.2% "}},edit_button:function(){return this.$vuetify.breakpoint.smAndDown?{style:"position: absolute; right: 40%; bottom:10% "}:{style:"position: absolute; left: 90%; top:80% "}},agentSlug:function(){return this.$store.getters["auth/getUser"].slug}},watch:{imageUrl:function(t){this.upload()}},mixins:[a.a,n.a],created:function(){var t=this;this.mixin_handleRequest(this.$store.dispatch("auth/getMyProfile").then(function(e){t.profile=e.data}))},methods:{upload:function(){var t=this;if(!this.imageBlob)return!1;var e=new FormData;e.append("profile_img",this.imageBlob),e.append("user_id",this.$store.getters["auth/getUser"].id),this.mixin_handleRequest(this.$store.dispatch("auth/uploadProfileImage",e).then(function(e){t.profile.profile_img=e.data,t.imageBlob=""}))},editProfile:function(){var t=this.$store.getters["auth/getUser"].slug;this.$router.push({name:"AgentProfile",params:{agentSlug:t}})}}},o={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-container",{staticClass:"page-wrapper",attrs:{"grid-list-md":"","text-xs-center":""}},[i("v-layout",{attrs:{row:"",wrap:""}},[i("v-flex",{attrs:{xs12:""}},[i("agent-info",{attrs:{agent_slug:t.agentSlug,image_src:t.imageUrl?t.imageUrl:t.profile.profile_img}},[i("template",{slot:"uploader"},[t.loading?i("v-progress-linear",{staticClass:"mt-0",attrs:{indeterminate:!0}}):t._e(),t._v(" "),i("v-btn",t._b({attrs:{fab:"",dark:"",color:"primary"},on:{click:t.pickFile}},"v-btn",t.upload_button,!1),[i("v-icon",{attrs:{dark:""}},[t._v("camera")])],1),t._v(" "),i("input",{ref:"image",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:t.onFilePicked}}),t._v(" "),i("v-btn",t._b({attrs:{fab:"",dark:"",color:"accent"},on:{click:t.editProfile}},"v-btn",t.edit_button,!1),[i("v-icon",{attrs:{dark:""}},[t._v("edit")])],1)],1)],2)],1)],1)],1)},staticRenderFns:[]};var s=i("VU/8")(r,o,!1,function(t){i("jC3m")},null,null);e.default=s.exports},jC3m:function(t,e){},"jRP+":function(t,e,i){"use strict";var a={data:function(){return{imageName:"",imageUrl:"",imageFile:"",_maxWidth:800,_maxHeight:600,_compressionQuality:.5,imageBlob:""}},methods:{pickFile:function(){this.$refs.image.click()},onFilePicked:function(t){var e=this,i=t.target.files;if(void 0!==i[0]){if(this.imageName=i[0].name,this.imageName.lastIndexOf(".")<=0)return;var a=new FileReader;a.readAsDataURL(i[0]),a.addEventListener("load",function(){e.imageUrl=a.result,e.imageFile=i[0];var t=new Image,n=void 0;t.onload=function(){n=e.calculateAspectRatioFit(t.naturalWidth,t.naturalHeight,e._maxWidth,e._maxHeight,e._compressionQuality),e.imageFile=e.imageToDataUri(t,n.width,n.height,n.quality),e.imageUrl=e.imageToDataUri(t,n.width,n.height,n.quality),e.imageBlob=e.convertImageToBlob(e.imageUrl,"image/jpeg"),console.log(e.imageBlob)},t.src=a.result})}else this.imageName="",this.imageFile="",this.imageUrl=""},calculateAspectRatioFit:function(t,e,i,a){var n=t,r=e,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,s=t/e,l=(i=i)/(a=a);return(e>a||t>i)&&(s<l?(s=a/r,r=a,n*=s):s>l?(n=i,r*=s=i/t):(n=i,r=a,o=1)),{width:n,height:r,quality:o}},imageToDataUri:function(t,e,i,a){var n=document.createElement("canvas"),r=n.getContext("2d");return n.width=e,n.height=i,r.drawImage(t,0,0,e,i),n.toDataURL("image/jpeg",a)},convertImageToBlob:function(t,e){for(var i=t.replace(/^data:image\/(png|jpeg|jpg);base64,/,""),a=e||"",n=window.atob(i),r=[],o=0,s=n.length;o<s;o+=1024){for(var l=n.slice(o,o+1024),u=new Array(l.length),g=0;g<l.length;g++)u[g]=l.charCodeAt(g);var c=new Uint8Array(u);r.push(c)}return new Blob(r,{type:a})}}};e.a=a}});
//# sourceMappingURL=4.02df9941803441390df0.js.map